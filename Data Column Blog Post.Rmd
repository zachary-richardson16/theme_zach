---
title: "Data Column Blog Post"
author: "Zachary Richardson"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Nearly every data scientist will say the same thing: The most important aspect of analytics is effectively communicating your results. So, how can you do this, whether it be in your practicum project, personal work, or in your career? The key is to make beautiful and easy-to-interpret visuals.

Currently, the `ggplot2` package in R provides several options for customizing your figures to give you the best visuals. But these themes still require a bit of tweaking to not only enhance the professionalism of your figures, but to also add a bit of personality in order to stand out. With this in mind, I decided to create a custom theme in R that will take my ggplot figures to the next level.

For this example, I will be creating a few very simple figures from R's built in `iris` data set, which contains data on the measurements of different iris flowers. A preview of this data set can be seen below:

```{r echo=FALSE, message=FALSE, warning=FALSE}
library(tidyverse)
library(kableExtra)

data("iris")

head(iris) %>%
  kbl() %>%
  kable_minimal()
  
```

To further show why I want to avoid using the default ggplot themes, I have created a very simple scatter plot. Here, R is using the default `ggplot` theme `theme_grey()`.

```{r echo=FALSE}
iris %>%
  ggplot(aes(x = Petal.Length, y = Sepal.Length, fill = Species)) +
  geom_point()
```

While this figure doesn't look too bad, it still needs a lot of work. Without editing the theme at all, let's add a facet, axis labels, a title, a subtitle, and a figure caption:

```{r echo=FALSE}
p <- iris %>%
  ggplot(aes(x = Petal.Length, y = Sepal.Length, fill = Species)) +
  geom_point() +
  #geom_bar(stat = "summary", fun = "mean") +
  xlab("Petal Length") +
  ylab("Sepal Length") +
  labs(
    title = "Sepal and Petal Length of Iris Flowers",
    subtitle = "Grouped by Species",
    caption = "Three iris flower species (setosa, versicolor, virginica)"
      ) +
  facet_wrap(~ Species)

p
```

This looks much cleaner than the first figure, but it still lacks good aesthetics. Let's table this figure for now and create a custom theme that can take it to the next level.

There are several starting options when creating a custom `ggplot` theme â€“ you can start from scratch, or start with a completed theme as a template. I found it most useful to start with the complete theme `theme_minimal()` to streamline the customization process. This theme is a stripped down version of the `ggplot` default, so it is the perfect template to start with. The code I began with is shown below. Notice the `%+replace%` operator, which allows the user to overwrite specific elements of the theme without having to start from scratch and without simply adding on to what already exists.

# ```{r}
# theme_zach <- function(base_size = 11, base_family = "") {
#   theme_minimal(base_size = base_size, base_family = base_family) %+replace%
#     theme(
#       ## TODO: Add theme elements
#     )
# }
# ```

The next part of the design process was to examine different features one at a time. My goal was to keep the figure as minimalized and "clean" as possible while still making important details stand out to quickly grab the viewer's attention and appear professional. I played around with different styles and elements in the figure including the title, subtitle, caption, axis text, tick marks, gridlines, legend, facets, and many more. Similar to stepwise model selection, I checked piece by piece how the theme looked, adding and removing elements until I was happy with the final product. 

The last thing I wanted to change was the default color and figure schemes used in R. The `ggplot` color palette commonly displays red and green, so I wanted to adjust this to be more colorblind friendly. Additionally, I chose to overwrite the `ggplot` default `geom_point()`, `geom_bar()`, and `geom_col()` functions to slightly alter the shape and colors of the points and bars in the figures.


```{r theme, include=FALSE}
## Initial custom theme, identical to theme_minimal()
theme_zach <- function(base_size = 11, base_family = "sans") {
  
  ## Create custom color palette for ggplot
  custom_palette = c(
    "#1E90FF", "#F28E2B", "#E15759", "#76B7B2", "#59A14F",
    "#EDC949", "#AF7AA1", "#FF9DA7", "#9C755F", "#BAB0AC"
    )
  
  ## Update default shape, size, outline color, and outline thickness for geom_point
  update_geom_defaults("point", list(shape = 21, size = 2, colour = "black", stroke = 0.5))
  
  ## Update default outline color for geom_bar and geom_col
  update_geom_defaults("bar", list(colour = "black"))
  update_geom_defaults("col", list(colour = "black"))
  
  ## Create custom theme
  list(
    
    ## The %+replace% operator allows you to modify elements in themes
    theme_minimal(base_size = base_size, base_family = base_family) %+replace%
      theme(
        
        ## Figure:
        # Title
        plot.title = element_text(
          size = rel(1.4), face = "bold", hjust = 0.5
        ),
        
        # Subtitle
        plot.subtitle = element_text(
          size = rel(1.1), margin = margin(b = 10)
        ),
        
        # Caption
        plot.caption = element_text(
          size = rel(0.8), hjust = 1
        ),
        
        ## Axes
        # Title
        axis.title = element_text(
          size = rel(1.1), face = "bold"
        ),
        
        # Tick-text
        axis.text = element_text(
          size = rel(1.0)
        ),
        
        # Axis lines
        axis.line = element_line(color = "black"),
        
        # Tick lines
        axis.ticks = element_line(color = "black"),
        
        ## Panel:
        # Major gridlines
        panel.grid.major = element_line(color = "grey85", linewidth = 0.2),
        
        # Minor gridlines
        panel.grid.minor = element_blank(),
        
        # Figure background
        panel.background = element_rect(fill = "white", color = "black"),
        
        ## Legend:
        # Position
        legend.position = "right",
        
        # Direction
        legend.direction = "vertical",
        
        # Text
        legend.text = element_text(size = rel(1.0)),
        
        # Title
        legend.title = element_text(face = "bold"),
        
        # Remove background
        legend.background = element_blank(),
        
        ## Facet labels:
        # Remove background
        strip.background = element_rect(fill = "white", color = "NA"),
        
        # Text
        strip.text = element_text(
          size = rel(0.9), face = "bold", margin = margin(b = 2))
        ),
    
    ## Update colors with custom palette
    scale_fill_manual(values = custom_palette),
    
    scale_color_manual(values = custom_palette)
    
    )
  
}
```


Now that the new theme is completed, let's revisit the previous figure and compare it to the same one with the theme added on:


```{r echo=FALSE}
## Original figure
p

## Figure with theme_zach
p + theme_zach()
```


The difference in the two figures is immediately noticeable, with more appropriately sized text, bolded labels and title, and an overall cleaner and more professional aesthetic.

Creating this theme was a small project I had been wanting to do for a while, and I can now use this anytime I am working on an assignment, a business report, or even doing exploratory data analysis at the beginning of a project. Not only did I learn more about `ggplot` and how to customize figure themes, but I also have a quick tool that will set my visuals apart when it comes to communicating my results. 

I encourage anyone who creates figures in their daily lives to play around with the customizable features of `ggplot`, and also **feel free to use my theme!** The code for this theme can be found on my GitHub through this link: TODO.

I hope you all enjoy using my custom theme, and I highly recommend making your own, even by starting with mine!


```{r include=FALSE}
## Simple bar plot
iris %>%
  ggplot(aes(x = Species, y = Sepal.Length, fill = Species)) +
  geom_bar(stat = "summary", fun = "mean")

## Simple barplot with theme_zach
iris %>%
  ggplot(aes(x = Species, y = Sepal.Length, fill = Species)) +
  geom_bar(stat = "summary", fun = "mean") +
  theme_zach()
```

